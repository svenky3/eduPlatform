<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup Quiz Questions in Firestore</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .button:hover {
            background: #5a67d8;
        }
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 6px;
            background: #e6f3ff;
            border: 1px solid #0066cc;
        }
        .success { background: #e6ffe6; border-color: #00cc00; color: #006600; }
        .error { background: #ffe6e6; border-color: #cc0000; color: #cc0000; }
        .question-preview {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üóÑÔ∏è Setup Quiz Questions Database</h1>
        <p>This tool will set up your quiz questions in Firebase Firestore, making them easy to manage and update.</p>
        
        <div class="status" id="status">
            Ready to setup questions database...
        </div>
        
        <button class="button" onclick="setupDatabase()">üìù Create Question Collection</button>
        <button class="button" onclick="addSampleQuestions()">üìö Add Sample Questions</button>
        <button class="button" onclick="testQuestions()">üß™ Test Question Loading</button>
        <button class="button" onclick="previewQuestions()">üëÄ Preview All Questions</button>
        
        <div id="questionsPreview"></div>
    </div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // Firebase Configuration - Your Actual Config
        const firebaseConfig = {
            apiKey: "AIzaSyAv4Z5vAl8knY9RNs_U5VFObU3WKJGuxqg",
            authDomain: "sat-education-platform.firebaseapp.com",
            projectId: "sat-education-platform",
            storageBucket: "sat-education-platform.firebasestorage.app",
            messagingSenderId: "860946166755",
            appId: "1:860946166755:web:58b4d314a3ecae88db26d6",
            measurementId: "G-PHHSDVW875"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        function updateStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
        }

        async function setupDatabase() {
            updateStatus('Setting up Firestore security rules...', 'info');
            
            try {
                // Test if we can write to Firestore
                await db.collection('test').add({
                    test: true,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                updateStatus('‚úÖ Database connection successful! Ready to add questions.', 'success');
            } catch (error) {
                updateStatus(`‚ùå Database setup failed: ${error.message}`, 'error');
                console.error('Database setup error:', error);
            }
        }

        async function addSampleQuestions() {
            updateStatus('Adding sample questions to database...', 'info');
            
            const sampleQuestions = [
                // Reading - Traditional
                {
                    subject: "reading",
                    format: "traditional",
                    difficulty: "medium",
                    question: "Based on the passage, what is the main theme?",
                    options: ["Love conquers all", "Technology vs nature", "The importance of education", "Family relationships"],
                    correct: 1,
                    explanation: "The passage primarily discusses the conflict between technological advancement and environmental preservation.",
                    tags: ["theme", "comprehension", "analysis"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                },
                {
                    subject: "reading",
                    format: "traditional", 
                    difficulty: "medium",
                    question: "Which literary device is primarily used in line 15?",
                    options: ["Metaphor", "Simile", "Alliteration", "Personification"],
                    correct: 0,
                    explanation: "The author uses metaphor to compare abstract concepts directly.",
                    tags: ["literary devices", "analysis"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                },
                
                // Reading - Jeopardy
                {
                    subject: "reading",
                    format: "jeopardy",
                    difficulty: "easy",
                    question: "This author wrote 'To Kill a Mockingbird'",
                    options: ["Who is Harper Lee?", "Who is Mark Twain?", "Who is John Steinbeck?", "Who is Maya Angelou?"],
                    correct: 0,
                    explanation: "Harper Lee wrote this classic novel about racial injustice in the American South.",
                    tags: ["authors", "classic literature"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                },
                {
                    subject: "reading",
                    format: "jeopardy",
                    difficulty: "medium",
                    question: "This Shakespeare play features the characters Romeo and Juliet",
                    options: ["What is Hamlet?", "What is Romeo and Juliet?", "What is Macbeth?", "What is Othello?"],
                    correct: 1,
                    explanation: "Romeo and Juliet is Shakespeare's famous tragedy about star-crossed lovers.",
                    tags: ["Shakespeare", "plays", "drama"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                },
                
                // Math - Traditional
                {
                    subject: "math",
                    format: "traditional",
                    difficulty: "medium",
                    question: "If 3x + 7 = 22, what is the value of x?",
                    options: ["3", "5", "7", "15"],
                    correct: 1,
                    explanation: "Subtract 7 from both sides: 3x = 15, then divide by 3: x = 5",
                    tags: ["algebra", "equations", "solving"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                },
                {
                    subject: "math",
                    format: "traditional",
                    difficulty: "medium", 
                    question: "What is the area of a circle with radius 4?",
                    options: ["8œÄ", "16œÄ", "12œÄ", "4œÄ"],
                    correct: 1,
                    explanation: "Area of circle = œÄr¬≤, so œÄ √ó 4¬≤ = 16œÄ",
                    tags: ["geometry", "circles", "area"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                },
                
                // Math - Jeopardy
                {
                    subject: "math",
                    format: "jeopardy",
                    difficulty: "easy",
                    question: "This is the value of œÄ rounded to two decimal places",
                    options: ["What is 3.14?", "What is 3.16?", "What is 3.12?", "What is 3.18?"],
                    correct: 0,
                    explanation: "œÄ (pi) is approximately 3.14159..., which rounds to 3.14",
                    tags: ["constants", "pi", "rounding"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                },
                
                // Writing - Traditional
                {
                    subject: "writing",
                    format: "traditional",
                    difficulty: "medium",
                    question: "Which sentence is grammatically correct?",
                    options: [
                        "The student's who studied hard passed the test.",
                        "The students who studied hard passed the test.", 
                        "The student's whom studied hard passed the test.",
                        "The students whom studied hard passed the test."
                    ],
                    correct: 1,
                    explanation: "Use 'students' (plural) with 'who' (subject pronoun) for the relative clause.",
                    tags: ["grammar", "pronouns", "sentence structure"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                },
                
                // Writing - Jeopardy
                {
                    subject: "writing",
                    format: "jeopardy",
                    difficulty: "easy",
                    question: "This punctuation mark is used to show possession",
                    options: ["What is an apostrophe?", "What is a comma?", "What is a semicolon?", "What is a colon?"],
                    correct: 0,
                    explanation: "The apostrophe (') is used to show possession, as in 'John's book'.",
                    tags: ["punctuation", "apostrophe", "possession"],
                    isActive: true,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                }
            ];

            try {
                const batch = db.batch();
                let count = 0;
                
                for (const question of sampleQuestions) {
                    const docRef = db.collection('quizQuestions').doc();
                    batch.set(docRef, question);
                    count++;
                }
                
                await batch.commit();
                updateStatus(`‚úÖ Successfully added ${count} sample questions to database!`, 'success');
                
            } catch (error) {
                updateStatus(`‚ùå Error adding questions: ${error.message}`, 'error');
                console.error('Error adding questions:', error);
            }
        }

        async function testQuestions() {
            updateStatus('Testing question loading...', 'info');
            
            try {
                // Test loading reading traditional questions
                const snapshot = await db.collection('quizQuestions')
                    .where('subject', '==', 'reading')
                    .where('format', '==', 'traditional')
                    .where('isActive', '==', true)
                    .get();
                
                const questions = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                updateStatus(`‚úÖ Successfully loaded ${questions.length} reading questions from database!`, 'success');
                console.log('Loaded questions:', questions);
                
            } catch (error) {
                updateStatus(`‚ùå Error loading questions: ${error.message}`, 'error');
                console.error('Error loading questions:', error);
            }
        }

        async function previewQuestions() {
            updateStatus('Loading all questions for preview...', 'info');
            
            try {
                const snapshot = await db.collection('quizQuestions')
                    .orderBy('subject')
                    .orderBy('format')
                    .get();
                
                const questions = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                const previewEl = document.getElementById('questionsPreview');
                previewEl.innerHTML = '<h3>üìö Questions Preview:</h3>';
                
                questions.forEach((q, index) => {
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question-preview';
                    questionDiv.innerHTML = `
                        <strong>${q.subject.toUpperCase()} - ${q.format}</strong> (${q.difficulty})
                        <br><strong>Q:</strong> ${q.question}
                        <br><strong>Options:</strong> ${q.options.join(' | ')}
                        <br><strong>Correct:</strong> ${q.options[q.correct]}
                        <br><strong>Tags:</strong> ${q.tags ? q.tags.join(', ') : 'None'}
                    `;
                    previewEl.appendChild(questionDiv);
                });
                
                updateStatus(`‚úÖ Loaded ${questions.length} questions for preview!`, 'success');
                
            } catch (error) {
                updateStatus(`‚ùå Error loading questions: ${error.message}`, 'error');
                console.error('Error loading questions:', error);
            }
        }
    </script>
</body>
</html>